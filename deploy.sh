#!/bin/bash
# ========================================
# DEPLOY SCRIPT FOR TELEGRAM MINI APP
# –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–º–æ–≥–∞–µ—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
# ========================================

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
GREEN='\033[0;32m'
BLUE='\033[0;34m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

echo -e "${BLUE}========================================${NC}"
echo -e "${BLUE}üöÄ –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–ï TELEGRAM MINI APP${NC}"
echo -e "${BLUE}========================================${NC}"

# –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
echo -e "\n${YELLOW}[1/6] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...${NC}"
npm install
if [ $? -eq 0 ]; then
    echo -e "${GREEN}‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã${NC}"
else
    echo -e "${RED}‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π${NC}"
    exit 1
fi

# –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
echo -e "\n${YELLOW}[2/6] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...${NC}"
if [ -z "$VITE_TELEGRAM_BOT_TOKEN" ]; then
    echo -e "${YELLOW}‚ö†Ô∏è  VITE_TELEGRAM_BOT_TOKEN –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω${NC}"
fi
if [ -z "$VITE_ADMIN_IDS" ]; then
    echo -e "${YELLOW}‚ö†Ô∏è  VITE_ADMIN_IDS –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω${NC}"
fi
echo -e "${GREEN}‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞${NC}"

# –®–∞–≥ 3: Build
echo -e "\n${YELLOW}[3/6] –°–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...${NC}"
npm run build
if [ $? -eq 0 ]; then
    echo -e "${GREEN}‚úÖ –°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞${NC}"
else
    echo -e "${RED}‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ${NC}"
    exit 1
fi

# –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞
echo -e "\n${YELLOW}[4/6] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Å–±–æ—Ä–∫–∏...${NC}"
SIZE=$(du -sh dist | cut -f1)
echo -e "${GREEN}‚úÖ –†–∞–∑–º–µ—Ä —Å–±–æ—Ä–∫–∏: $SIZE${NC}"

# –®–∞–≥ 5: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏
echo -e "\n${YELLOW}[5/6] –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:${NC}"
echo -e "1. –ö–æ–º–º–∏—Ç –≤ Git: ${BLUE}git add . && git commit -m 'Deploy to Telegram Mini App'${NC}"
echo -e "2. Push –Ω–∞ GitHub: ${BLUE}git push origin main${NC}"
echo -e "3. –ü–µ—Ä–µ–π—Ç–∏ –≤ Vercel/Netlify –∏ –≤—ã–±—Ä–∞—Ç—å –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π"
echo -e "4. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏"

# –®–∞–≥ 6: –ì–æ—Ç–æ–≤–æ
echo -e "\n${YELLOW}[6/6] –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞${NC}"
echo -e "${GREEN}‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é!${NC}"

echo -e "\n${BLUE}========================================${NC}"
echo -e "${GREEN}üéâ –í–°–Å –ì–û–¢–û–í–û!${NC}"
echo -e "${BLUE}========================================${NC}"
